data and scripts underlying the results of the manuscript: "Flexible foraging behaviour increases vulnerability to climate change".

Important note: As all the intermediate files are already saved, it is not mandatory to go through the entire workflow (see dedicated section below) to run the final scripts (i.e. the ones doing the statistical analyses and plotting the results). It is possible to directly focus (for instance) on the final script (Kiel-bay_summary.Rmd) that will load the needed files. 

# The repository is organised in several subfolders:
 
Each subfolder contains its own readme file with more explanations.
The files generated by the different scripts are saved in the 'generated files' folder to make possible the exploration of different parts of the code without having to run everything from the beginning. Especially, bayesian fitting (i.e what is in the fitting distributions folder) can be rather long.

## main folder:
The utils.R script contains various functions useful in different parts of the workflow, such as removing fish for which the estimation of the prey body mass distribution in stomachs cannot be fitted properly (too few data points) or to convert fish size to fish biomass (using equations from fishbase).

## data:
Contains raw data, extracted from the database + scripts to associate fish to benthic environments. 

## generated files: 
Contains the data and the files generated through the different processes (see details below about the workflow). The file generations are explained in detail in the local readme files

## Kernel_densities:
contains the scripts used to fit the different distributions (stomach and environmental) and estimate preference distributions

## data analyses:
Contains the script to analyse data and create figures.

## allometric_preferences_model
Contains the updated version of the ATNr package to incorporate species flexible foraging behaviour. As well as (i) the different scripts to generate the different parameters used (temperature, consideration of flexible foraging behaviour, sensitivity analysis on enrichment and Hill exponent) (ii) the script to run the model and save results (iii) the bash scripts to start the simulations on a HPC

